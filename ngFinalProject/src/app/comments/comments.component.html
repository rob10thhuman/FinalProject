<h4>Comments</h4>
<button
  class="btn-success"
  *ngIf="!newComment && isLoggedIn()"
  (click)="setupAddingComment()"
>
  Add New Comment
</button>

<form *ngIf="newComment">
  <textarea
    rows="5"
    cols="40"
    name="comment"
    [(ngModel)]="newComment.comment"
  ></textarea>
  <br />
  <button (click)="addComment(newComment)" class="btn btn-success">Add</button>
  <button (click)="teardownAddingComment()" class="btn btn-danger">
    Cancel
  </button>
</form>

<ul>
  <li *ngFor="let comment of comments" class="comment">
    {{ comment.user.username }}
    Date: {{ comment.dateUpdated | date: 'shortDate' }}
    <p>{{ comment.comment }}</p>
    <div
      class="btn-group"
      *ngIf="isLoggedInUsername(comment.user.username) && !updatingComment"
    >
      <button class="btn btn-primary" (click)="setupUpdatingComment(comment)">
        Edit
      </button>
      <button class="btn btn-danger" (click)="deleteComment(comment.id)">
        Delete
      </button>
    </div>

    <div
      class="btn-group"
      *ngIf="!isLoggedInUsername(comment.user.username) && !updatingComment"
    >
      <button class="btn btn-success" (click)="voteComment(comment, true)">
        Upvote
      </button>
      <button class="btn btn-danger" (click)="voteComment(comment, false)">
        Downvote
      </button>
    </div>

    <form *ngIf="checkUpdatingFormConditions(comment)">
      <textarea
        rows="5"
        cols="40"
        name="comment"
        [(ngModel)]="updatingComment.comment"
      ></textarea>
      <br />
      <div class="btn-group">
        <button
          (click)="updateComment(updatingComment.id, updatingComment)"
          class="btn btn-primary"
        >
          Update
        </button>
        <button (click)="teardownUpdatingComment()" class="btn btn-danger">
          Cancel
        </button>
      </div>
    </form>
  </li>
</ul>
